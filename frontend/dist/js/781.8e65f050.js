"use strict";(self["webpackChunkacademic_management_frontend"]=self["webpackChunkacademic_management_frontend"]||[]).push([[781],{4781:function(e,t,l){l.r(t),l.d(t,{default:function(){return h}});var r=l(641),a=l(33),n=l(3751);const o={class:"project-form"},u={class:"page-header"},d={class:"form-container"};function s(e,t,l,s,i,m){const c=(0,r.g2)("ArrowLeft"),f=(0,r.g2)("el-icon"),p=(0,r.g2)("el-button"),b=(0,r.g2)("el-input"),g=(0,r.g2)("el-form-item"),h=(0,r.g2)("el-option"),k=(0,r.g2)("el-select"),F=(0,r.g2)("el-input-number"),v=(0,r.g2)("el-date-picker"),_=(0,r.g2)("el-col"),A=(0,r.g2)("el-row"),V=(0,r.g2)("el-radio"),j=(0,r.g2)("el-radio-group"),w=(0,r.g2)("el-form");return(0,r.uX)(),(0,r.CE)("div",o,[(0,r.Lk)("div",u,[(0,r.Lk)("h1",null,(0,a.v_)(s.isEdit?"编辑项目":"创建项目"),1),(0,r.bF)(p,{onClick:s.handleBack},{default:(0,r.k6)(()=>[(0,r.bF)(f,null,{default:(0,r.k6)(()=>[(0,r.bF)(c)]),_:1}),t[8]||(t[8]=(0,r.eW)(" 返回 ",-1))]),_:1},8,["onClick"])]),(0,r.Lk)("div",d,[(0,r.bF)(w,{ref:"formRef",model:s.form,rules:s.rules,"label-width":"120px",onSubmit:(0,n.D$)(s.handleSubmit,["prevent"])},{default:(0,r.k6)(()=>[(0,r.bF)(g,{label:"项目名称",prop:"name"},{default:(0,r.k6)(()=>[(0,r.bF)(b,{modelValue:s.form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.form.name=e),placeholder:"请输入项目名称",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),(0,r.bF)(g,{label:"项目类型",prop:"type"},{default:(0,r.k6)(()=>[(0,r.bF)(k,{modelValue:s.form.type,"onUpdate:modelValue":t[1]||(t[1]=e=>s.form.type=e),placeholder:"请选择项目类型",style:{width:"100%"}},{default:(0,r.k6)(()=>[(0,r.bF)(h,{label:"研究项目",value:"RESEARCH"}),(0,r.bF)(h,{label:"创新项目",value:"INNOVATION"}),(0,r.bF)(h,{label:"实践项目",value:"PRACTICE"})]),_:1},8,["modelValue"])]),_:1}),(0,r.bF)(g,{label:"项目描述",prop:"description"},{default:(0,r.k6)(()=>[(0,r.bF)(b,{modelValue:s.form.description,"onUpdate:modelValue":t[2]||(t[2]=e=>s.form.description=e),type:"textarea",rows:4,placeholder:"请输入项目描述",maxlength:"1000","show-word-limit":""},null,8,["modelValue"])]),_:1}),(0,r.bF)(g,{label:"项目级别",prop:"level"},{default:(0,r.k6)(()=>[(0,r.bF)(k,{modelValue:s.form.level,"onUpdate:modelValue":t[3]||(t[3]=e=>s.form.level=e),placeholder:"请选择项目级别",style:{width:"100%"}},{default:(0,r.k6)(()=>[(0,r.bF)(h,{label:"国家级",value:"NATIONAL"}),(0,r.bF)(h,{label:"省级",value:"PROVINCIAL"}),(0,r.bF)(h,{label:"校级",value:"SCHOOL"})]),_:1},8,["modelValue"])]),_:1}),(0,r.bF)(g,{label:"项目经费"},{default:(0,r.k6)(()=>[(0,r.bF)(F,{modelValue:s.form.funding,"onUpdate:modelValue":t[4]||(t[4]=e=>s.form.funding=e),min:0,max:1e7,placeholder:"请输入项目经费",style:{width:"100%"},precision:2},null,8,["modelValue"])]),_:1}),(0,r.bF)(A,{gutter:20},{default:(0,r.k6)(()=>[(0,r.bF)(_,{span:12},{default:(0,r.k6)(()=>[(0,r.bF)(g,{label:"开始日期",prop:"startDate"},{default:(0,r.k6)(()=>[(0,r.bF)(v,{modelValue:s.form.startDate,"onUpdate:modelValue":t[5]||(t[5]=e=>s.form.startDate=e),type:"date",placeholder:"选择开始日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),(0,r.bF)(_,{span:12},{default:(0,r.k6)(()=>[(0,r.bF)(g,{label:"结束日期",prop:"endDate"},{default:(0,r.k6)(()=>[(0,r.bF)(v,{modelValue:s.form.endDate,"onUpdate:modelValue":t[6]||(t[6]=e=>s.form.endDate=e),type:"date",placeholder:"选择结束日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,r.bF)(g,{label:"项目状态",prop:"status"},{default:(0,r.k6)(()=>[(0,r.bF)(j,{modelValue:s.form.status,"onUpdate:modelValue":t[7]||(t[7]=e=>s.form.status=e)},{default:(0,r.k6)(()=>[(0,r.bF)(V,{label:"PLANNING"},{default:(0,r.k6)(()=>[...t[9]||(t[9]=[(0,r.eW)("规划中",-1)])]),_:1}),(0,r.bF)(V,{label:"ONGOING"},{default:(0,r.k6)(()=>[...t[10]||(t[10]=[(0,r.eW)("进行中",-1)])]),_:1}),(0,r.bF)(V,{label:"COMPLETED"},{default:(0,r.k6)(()=>[...t[11]||(t[11]=[(0,r.eW)("已完成",-1)])]),_:1}),(0,r.bF)(V,{label:"CANCELLED"},{default:(0,r.k6)(()=>[...t[12]||(t[12]=[(0,r.eW)("已取消",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,r.bF)(g,null,{default:(0,r.k6)(()=>[(0,r.bF)(p,{type:"primary",loading:s.loading,onClick:s.handleSubmit},{default:(0,r.k6)(()=>[(0,r.eW)((0,a.v_)(s.isEdit?"更新":"创建"),1)]),_:1},8,["loading","onClick"]),(0,r.bF)(p,{onClick:s.handleReset},{default:(0,r.k6)(()=>[...t[13]||(t[13]=[(0,r.eW)("重置",-1)])]),_:1},8,["onClick"]),(0,r.bF)(p,{onClick:s.handleBack},{default:(0,r.k6)(()=>[...t[14]||(t[14]=[(0,r.eW)("取消",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules","onSubmit"])])])}var i=l(953),m=l(5220),c=l(163),f=l(6698),p={name:"ProjectForm",setup(){const e=(0,m.rd)(),t=(0,m.lq)(),l=(0,i.KR)(),a=(0,i.KR)(!1),n=(0,r.EW)(()=>!!t.params.id),o=(0,i.Kh)({name:"",type:"",description:"",level:"",funding:0,startDate:"",endDate:"",status:"PLANNING"}),u={name:[{required:!0,message:"请输入项目名称",trigger:"blur"},{min:2,max:200,message:"名称长度在2到200个字符",trigger:"blur"}],type:[{required:!0,message:"请选择项目类型",trigger:"change"}],description:[{required:!0,message:"请输入项目描述",trigger:"blur"},{min:10,max:1e3,message:"描述长度在10到1000个字符",trigger:"blur"}],level:[{required:!0,message:"请选择项目级别",trigger:"change"}],startDate:[{required:!0,message:"请选择开始日期",trigger:"change"}],endDate:[{required:!0,message:"请选择结束日期",trigger:"change"}],status:[{required:!0,message:"请选择项目状态",trigger:"change"}]},d=async()=>{if(n.value)try{const e=t.params.id,l=await(0,f.G6)(e);console.log("获取项目详情响应:",l);let r=l;if(l&&l.data&&(r=l.data),!r||!r.id)throw new Error("获取项目数据失败");Object.assign(o,r)}catch(e){console.error("加载项目数据失败:",e),c.nk.error("加载项目数据失败")}},s=async()=>{l.value&&await l.value.validate(async l=>{if(l){a.value=!0;try{const l={...o};if(console.log("提交数据:",l),n.value){const e=t.params.id;await(0,f.vr)(e,l),c.nk.success("项目更新成功")}else await(0,f.gA)(l),c.nk.success("项目创建成功");e.push("/dashboard/projects")}catch(r){console.error("操作失败:",r),c.nk.error(r.response?.data?.message||"操作失败")}finally{a.value=!1}}})},p=()=>{l.value&&l.value.resetFields()},b=()=>{e.push("/dashboard/projects")};return(0,r.sV)(()=>{d()}),{formRef:l,loading:a,isEdit:n,form:o,rules:u,handleSubmit:s,handleReset:p,handleBack:b}}},b=l(6262);const g=(0,b.A)(p,[["render",s],["__scopeId","data-v-ed4330f0"]]);var h=g},6698:function(e,t,l){l.d(t,{CE:function(){return f},G6:function(){return n},J2:function(){return h},Rv:function(){return b},cf:function(){return a},gA:function(){return o},hr:function(){return m},iz:function(){return k},jY:function(){return p},jh:function(){return c},nB:function(){return g},pH:function(){return s},vr:function(){return u},wV:function(){return i},xx:function(){return d}});var r=l(86);function a(e={}){return(0,r.A)({url:"/projects",method:"get",params:e})}function n(e){return(0,r.A)({url:`/projects/${e}`,method:"get"})}function o(e){return(0,r.A)({url:"/projects",method:"post",data:e})}function u(e,t){return(0,r.A)({url:`/projects/${e}`,method:"put",data:t})}function d(e){return(0,r.A)({url:`/projects/${e}`,method:"delete"})}function s(e,t){return(0,r.A)({url:`/projects/${e}/members`,method:"post",data:{memberId:t,role:"MEMBER"}})}function i(e,t){return(0,r.A)({url:`/projects/${e}/members/${t}`,method:"delete"})}function m(e){return(0,r.A)({url:`/projects/${e}/members`,method:"get"})}function c(e,t){return(0,r.A)({url:`/projects/${e}/milestones`,method:"post",data:t})}function f(e,t,l){return(0,r.A)({url:`/projects/${e}/milestones/${t}`,method:"put",data:l})}function p(e){return(0,r.A)({url:`/projects/${e}/milestones`,method:"get"})}function b(e){return(0,r.A)({url:`/projects/${e}/files`,method:"get"})}function g(e,t){return(0,r.A)({url:`/projects/${e}/files/${t}`,method:"delete"})}function h(e){return(0,r.A)({url:`/projects/leaderDetail/${e}`,method:"get"})}function k(){return(0,r.A)({url:"/projects/available-students",method:"get"})}}}]);
//# sourceMappingURL=781.8e65f050.js.map