"use strict";(self["webpackChunkacademic_management_frontend"]=self["webpackChunkacademic_management_frontend"]||[]).push([[268],{3268:function(e,n,o){o.r(n),o.d(n,{default:function(){return k}});var r=o(641),a=o(3751);const l={class:"login-container"},t={class:"login-form"},s={class:"login-footer"};function u(e,n,o,u,i,d){const c=(0,r.g2)("el-input"),g=(0,r.g2)("el-form-item"),m=(0,r.g2)("el-button"),p=(0,r.g2)("el-link"),f=(0,r.g2)("el-form");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.Lk)("div",t,[n[5]||(n[5]=(0,r.Lk)("div",{class:"login-header"},[(0,r.Lk)("h1",null,"学术活动与科研成果管理系统"),(0,r.Lk)("p",null,"Academic Activity & Research Achievement Management System")],-1)),(0,r.bF)(f,{ref:"loginFormRef",model:u.loginForm,rules:u.loginRules,class:"login-form-content",onSubmit:(0,a.D$)(u.handleLogin,["prevent"])},{default:(0,r.k6)(()=>[(0,r.bF)(g,{prop:"username"},{default:(0,r.k6)(()=>[(0,r.bF)(c,{modelValue:u.loginForm.username,"onUpdate:modelValue":n[0]||(n[0]=e=>u.loginForm.username=e),placeholder:"请输入用户名","prefix-icon":"User",size:"large"},null,8,["modelValue"])]),_:1}),(0,r.bF)(g,{prop:"password"},{default:(0,r.k6)(()=>[(0,r.bF)(c,{modelValue:u.loginForm.password,"onUpdate:modelValue":n[1]||(n[1]=e=>u.loginForm.password=e),type:"password",placeholder:"请输入密码","prefix-icon":"Lock",size:"large","show-password":"",onKeyup:(0,a.jR)(u.handleLogin,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),(0,r.bF)(g,null,{default:(0,r.k6)(()=>[(0,r.bF)(m,{type:"primary",size:"large",loading:u.loading,onClick:u.handleLogin,class:"login-button"},{default:(0,r.k6)(()=>[...n[3]||(n[3]=[(0,r.eW)(" 登录 ",-1)])]),_:1},8,["loading","onClick"])]),_:1}),(0,r.Lk)("div",s,[(0,r.bF)(p,{type:"primary",onClick:n[2]||(n[2]=n=>e.$router.push("/register"))},{default:(0,r.k6)(()=>[...n[4]||(n[4]=[(0,r.eW)(" 还没有账号？立即注册 ",-1)])]),_:1})])]),_:1},8,["model","rules","onSubmit"])])])}var i=o(953),d=o(5220),c=o(6278),g=o(163),m=o(5565),p={name:"Login",setup(){const e=(0,d.rd)(),n=(0,c.Pj)(),o=(0,i.KR)(),r=(0,i.KR)(!1),a=(0,i.Kh)({username:"",password:""}),l={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}]},t=async()=>{o.value&&await o.value.validate(async o=>{if(o){r.value=!0;try{const o=await(0,m.iD)(a);if(200===o.code){const{token:r,user:a}=o.data,l=a.roles&&a.roles.length>0?a.roles[0]:"STUDENT";console.log("用户角色:",l),n.dispatch("login",{token:r,user:a,role:l}),g.nk.success("登录成功"),e.push("/dashboard")}else g.nk.error(o.message||"登录失败")}catch(l){g.nk.error("登录失败，请检查用户名和密码")}finally{r.value=!1}}})};return{loginFormRef:o,loginForm:a,loginRules:l,loading:r,handleLogin:t}}},f=o(6262);const h=(0,f.A)(p,[["render",u],["__scopeId","data-v-367a0236"]]);var k=h},5565:function(e,n,o){o.d(n,{ec:function(){return t},iD:function(){return a},kz:function(){return l},r7:function(){return s}});var r=o(86);function a(e){return(0,r.A)({url:"/auth/login",method:"post",data:e})}function l(e){return(0,r.A)({url:"/auth/register",method:"post",data:e})}function t(e){return(0,r.A)({url:"/auth/change-password",method:"post",data:e})}function s(e){return(0,r.A)({url:"/auth/update-profile",method:"post",data:e})}}}]);
//# sourceMappingURL=268.93779801.js.map