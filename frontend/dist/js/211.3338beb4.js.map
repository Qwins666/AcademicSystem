{"version":3,"file":"js/211.3338beb4.js","mappings":"4TAGO,SAASA,EAAmBC,EAAS,CAAC,GAC3C,OAAO,OAAQ,CACbC,IAAK,gBACLC,OAAQ,MACRF,UAEJ,CAGO,SAASG,EAAmBC,GACjC,OAAO,OAAQ,CACbH,IAAK,iBAAiBG,IACtBF,OAAQ,OAEZ,CAGO,SAASG,EAAkBC,GAChC,OAAO,OAAQ,CACbL,IAAK,gBACLC,OAAQ,OACRI,QAEJ,CAGO,SAASC,EAAkBH,EAAIE,GACpC,OAAO,OAAQ,CACbL,IAAK,iBAAiBG,IACtBF,OAAQ,MACRI,QAEJ,CAGO,SAASE,EAAkBJ,GAChC,OAAO,OAAQ,CACbH,IAAK,iBAAiBG,IACtBF,OAAQ,UAEZ,CAmBO,SAASO,EAAoBC,GAClC,OAAO,OAAQ,CACbT,IAAK,2BAA2BS,IAChCR,OAAQ,OAEZ,C,kGClEOS,MAAM,oB,GACJA,MAAM,e,GAaNA,MAAM,oB,GAuCNA,MAAM,mB,GA0EJA,MAAM,wB,aA2CFA,MAAM,iB,4dA1KnB,QAiLM,MAjLN,EAiLM,EAhLJ,QAUM,MAVN,EAUM,C,aATJ,QAAa,UAAT,QAAI,IAIA,EAAAC,cAAc,CAAC,c,WAHvB,QAOY,G,MANVC,KAAK,UACJ,QAAO,EAAAC,c,kBAGR,IAA2B,EAA3B,QAA2B,Q,iBAAlB,IAAQ,EAAR,QAAQ,K,2BAAU,UAE7B,M,wCAIF,QAoCM,MApCN,EAoCM,EAnCJ,QAkCU,GAlCAC,MAAO,EAAAC,WAAYC,OAAA,I,kBAC3B,IAMe,EANf,QAMe,GANDC,MAAM,QAAM,C,iBACxB,IAIE,EAJF,QAIE,G,WAHS,EAAAF,WAAWG,M,qCAAX,EAAAH,WAAgB,SACzBI,YAAY,UACZC,UAAA,I,gCAGJ,QAOe,GAPDH,MAAM,QAAM,C,iBACxB,IAKY,EALZ,QAKY,G,WALQ,EAAAF,WAAWH,K,qCAAX,EAAAG,WAAe,QAAEM,MAAA,gBAAqBF,YAAY,QAAQC,UAAA,I,kBAC5E,IAAsC,EAAtC,QAAsC,GAA3BH,MAAM,KAAKK,MAAM,WAC5B,QAAuC,GAA5BL,MAAM,KAAKK,MAAM,YAC5B,QAA4C,GAAjCL,MAAM,KAAKK,MAAM,iBAC5B,QAAwC,GAA7BL,MAAM,KAAKK,MAAM,c,gCAGhC,QAOe,GAPDL,MAAM,QAAM,C,iBACxB,IAKY,EALZ,QAKY,G,WALQ,EAAAF,WAAWQ,O,qCAAX,EAAAR,WAAiB,UAAEM,MAAA,gBAAqBF,YAAY,QAAQC,UAAA,I,kBAC9E,IAAyC,EAAzC,QAAyC,GAA9BH,MAAM,MAAMK,MAAM,aAC7B,QAA+C,GAApCL,MAAM,MAAMK,MAAM,mBAC7B,QAA0C,GAA/BL,MAAM,MAAMK,MAAM,cAC7B,QAA0C,GAA/BL,MAAM,MAAMK,MAAM,e,gCAGjC,QASe,Q,iBARb,IAGY,EAHZ,QAGY,GAHDV,KAAK,UAAW,QAAO,EAAAY,c,kBAChC,IAA6B,EAA7B,QAA6B,Q,iBAApB,IAAU,EAAV,QAAU,K,6BAAU,QAE/B,M,qBACA,QAGY,GAHA,QAAO,EAAAC,aAAW,C,iBAC5B,IAA8B,EAA9B,QAA8B,Q,iBAArB,IAAW,EAAX,QAAW,K,6BAAU,QAEhC,M,mDAMN,QA2HM,MA3HN,EA2HM,E,qBA1HJ,QAsEW,GAtEApB,KAAM,EAAAqB,iBAAe,C,iBAC9B,IAA6D,EAA7D,QAA6D,GAA5CC,KAAK,QAAQV,MAAM,OAAO,YAAU,SACrD,QAMkB,GANDU,KAAK,OAAOV,MAAM,KAAKW,MAAM,O,CACjCC,SAAO,QAGP,GAHc,EACvB,QAES,GAFAjB,KAAM,EAAAkB,WAAWC,EAAMC,IAAIpB,O,kBAClC,IAAiC,E,iBAA9B,EAAAqB,YAAYF,EAAMC,IAAIpB,OAAI,K,6BAInC,QAMkB,GANDe,KAAK,QAAQV,MAAM,KAAKW,MAAM,O,CAClCC,SAAO,QAER,GAFe,CACTE,EAAMC,IAAS,Q,WAA7B,QAES,G,MAFuBpB,KAAM,EAAAsB,YAAYH,EAAMC,IAAIG,Q,kBAC1D,IAAmC,E,iBAAhC,EAAAC,aAAaL,EAAMC,IAAIG,QAAK,K,8CAIrC,QAAgE,GAA/CR,KAAK,gBAAgBV,MAAM,MAAMW,MAAM,SACxD,QAA8D,GAA7CD,KAAK,aAAaV,MAAM,OAAOW,MAAM,SACtD,QAMkB,GANDD,KAAK,SAASV,MAAM,KAAKW,MAAM,O,CACnCC,SAAO,QAGP,GAHc,EACvB,QAES,GAFAjB,KAAM,EAAAyB,aAAaN,EAAMC,IAAIT,S,kBACpC,IAAqC,E,iBAAlC,EAAAe,cAAcP,EAAMC,IAAIT,SAAM,K,6BAIvC,QA4CkB,GA5CDN,MAAM,KAAKW,MAAM,MAAMW,MAAM,S,CACjCV,SAAO,QAOJ,GAPW,EACvB,QAMY,GALVjB,KAAK,UACL4B,KAAK,QACJ,QAAK,GAAE,EAAAC,WAAWV,EAAMC,M,kBAC1B,IAED,oB,QAFC,QAED,O,oBAKQ,EAAAU,QAAQX,EAAMC,O,WAJtB,QAOY,G,MANVpB,KAAK,UACL4B,KAAK,QACJ,QAAK,GAAE,EAAAG,WAAWZ,EAAMC,M,kBAE1B,IAED,oB,QAFC,QAED,O,qCAMQ,EAAAY,WAAWb,EAAMC,O,WAJzB,QAOY,G,MANVpB,KAAK,UACL4B,KAAK,QACJ,QAAK,GAAE,EAAAK,cAAcd,EAAMC,M,kBAG5B,IAAsC,E,iBAAnC,EAAAc,sBAAsBf,EAAMC,MAAG,K,wCAO5B,EAAArB,cAAc,CAAC,WAAkC,YAArBoB,EAAMC,IAAIT,SAAyB,EAAAqB,WAAWb,EAAMC,O,WAJxF,QAOY,G,MANVpB,KAAK,OACL4B,KAAK,QACLO,SAAA,I,kBAED,IAED,oB,QAFC,SAED,O,uBAKQ,EAAAC,UAAUjB,EAAMC,O,WAJxB,QAOY,G,MANVpB,KAAK,SACL4B,KAAK,QACJ,QAAK,GAAE,EAAAS,aAAalB,EAAMC,M,kBAE5B,IAED,oB,QAFC,QAED,O,qEAnEuC,EAAAkB,YAyE7C,QAUM,MAVN,EAUM,EATJ,QAQE,GAPQ,eAAc,EAAAC,WAAWC,Q,sCAAX,EAAAD,WAAkB,WAChC,YAAW,EAAAA,WAAWX,K,mCAAX,EAAAW,WAAe,QACjCE,MAAO,EAAAF,WAAWE,MAClB,aAAY,CAAC,GAAI,GAAI,GAAI,KAC1BC,OAAO,0CACN,aAAa,EAAAC,iBACb,gBAAgB,EAAAC,qB,iFAKrB,QAmCY,G,WAlCD,EAAAC,sB,qCAAA,EAAqB,yBAC7BvC,MAAK,GAAoC,YAA/B,EAAAwC,oBAAoBnC,OAAuB,KAAO,WAAW,EAAAmC,oBAAoBxC,QAC5FU,MAAM,QACNlB,MAAM,mB,CAyBKiD,QAAM,QACf,IAGM,EAHN,QAGM,MAHN,EAGM,EAFJ,QAAsD,GAA1C,QAAO,EAAAC,qBAAmB,C,iBAAE,IAAE,oB,QAAF,MAAE,O,qBAC1C,QAAgE,GAArDhD,KAAK,UAAW,QAAO,EAAAiD,gB,kBAAgB,IAAE,oB,QAAF,MAAE,O,yCAtBpC,IAgCpB,CApCW,EAAkB,qB,WAA7B,QAqBM,UApBJ,QAmBU,GAlBP/C,MAAO,EAAAgD,aACR,cAAY,Q,kBAEZ,IAKe,EALf,QAKe,GALD7C,MAAM,QAAM,C,iBACxB,IAGiB,EAHjB,QAGiB,G,WAHQ,EAAA6C,aAAaC,S,qCAAb,EAAAD,aAAqB,a,kBAC5C,IAAqC,EAArC,QAAqC,GAA1B7C,OAAO,GAAI,C,iBAAE,IAAE,oB,QAAF,MAAE,O,OAC1B,QAAsC,GAA3BA,OAAO,GAAK,C,iBAAE,IAAE,oB,QAAF,MAAE,O,wCAI/B,QAOe,GAPDA,MAAM,QAAM,C,iBACxB,IAKE,EALF,QAKE,G,WAJS,EAAA6C,aAAaE,Q,qCAAb,EAAAF,aAAoB,WAC7BlD,KAAK,WACJqD,KAAM,EACP9C,YAAY,W,iLAyB5B,GACE+C,KAAM,kBACN,KAAAC,GACE,MAAMC,GAAS,UACTC,GAAQ,UAERnB,GAAU,SAAI,GACdxB,GAAkB,QAAI,IACtB4C,GAAY,QAAI,IAAIC,KAEpBxD,GAAa,QAAS,CAC1BG,MAAO,GACPN,KAAM,GACNW,OAAQ,KAGJ4B,GAAa,QAAS,CAC1BC,QAAS,EACTZ,KAAM,GACNa,MAAO,IAGHmB,GAAW,QAAS,IAAMH,EAAMI,QAAQD,UACxC/D,GAAS,QAAS,IAAM4D,EAAMI,QAAQC,MAAMvE,IAG5CsD,GAAwB,SAAI,GAC5BC,GAAqB,QAAI,MACzBI,GAAe,QAAS,CAC5BC,UAAU,EACVC,QAAS,KAGLrD,EAAiBgE,GACdA,EAAMC,SAASJ,EAASlD,OAG3BW,EAAerB,IACnB,MAAMiE,EAAU,CACd,MAAS,KACT,OAAU,KACV,YAAe,KACf,QAAW,MAEb,OAAOA,EAAQjE,IAASA,GAGpBkB,EAAclB,IAClB,MAAMkE,EAAS,CACb,MAAS,UACT,OAAU,UACV,YAAe,UACf,QAAW,QAEb,OAAOA,EAAOlE,IAAS,QAGnBwB,EAAgBD,IACpB,MAAM4C,EAAW,CACf,SAAY,MACZ,WAAc,KACd,OAAU,MAEZ,OAAOA,EAAS5C,IAAUA,GAGtBD,EAAeC,IACnB,MAAM2C,EAAS,CACb,SAAY,SACZ,WAAc,UACd,OAAU,WAEZ,OAAOA,EAAO3C,IAAU,QAGpBG,EAAiBf,IACrB,MAAMyD,EAAY,CAChB,QAAW,MACX,cAAiB,MACjB,SAAY,MACZ,SAAY,OAEd,OAAOA,EAAUzD,IAAWA,GAGxBc,EAAgBd,IACpB,MAAMuD,EAAS,CACb,QAAW,UACX,cAAiB,UACjB,SAAY,UACZ,SAAY,UAEd,OAAOA,EAAOvD,IAAW,QAGrBmB,EAAWuC,GACRtE,EAAc,CAAC,aACfsE,EAAYC,cAAgBzE,EAAOa,OACZ,YAAvB2D,EAAY1D,OAGfqB,EAAcqC,MAEdtE,EAAc,CAAC,aAAsC,YAAvBsE,EAAY1D,YAI1CZ,EAAc,CAAC,WAAoC,kBAAvBsE,EAAY1D,QAOxCuB,EAAyBmC,GACF,YAAvBA,EAAY1D,OACY,YAAnBiD,EAASlD,MAAsB,KAAO,MAEpB,kBAAvB2D,EAAY1D,QAA8BZ,EAAc,CAAC,UACpD,KAEF,KAGHqC,EAAaiC,GACVtE,EAAc,CAAC,aACfsE,EAAYC,cAAgBzE,EAAOa,OACZ,YAAvB2D,EAAY1D,OAIf4D,EAAkBC,MAAO3E,IAE7B,GAAI6D,EAAUhD,MAAM+D,IAAI5E,GAEtB,OADA6E,QAAQC,IAAI,eAAgBjB,EAAUhD,MAAMkE,IAAI/E,IACzC6D,EAAUhD,MAAMkE,IAAI/E,GAG7B,IACE6E,QAAQC,IAAI,SAAS9E,OACrB,MAAMgF,QAAiBC,EAAA,EAAQF,IAAI,gBAAgB/E,KACnD6E,QAAQC,IAAI,OAAO9E,SAAegF,GAClC,MAAME,EAAWF,GAAUpF,MAAQoF,EAEnC,OADAnB,EAAUhD,MAAMsE,IAAInF,EAAQkF,GACrBA,CACT,CAAE,MAAOE,GAGP,OAFAP,QAAQO,MAAM,OAAOpF,SAAeoF,GAE7B,CAAEC,SAAU,OAAQC,SAAU,OACvC,GAIIC,EAAgCZ,MAAOa,IAC3C,MAAMC,EAAWD,EAAaE,IAAIf,MAAOH,IACvC,GAAIA,EAAYC,YAAa,CAC3B,MAAMS,QAAiBR,EAAgBF,EAAYC,aAEnDD,EAAYmB,cAAgBT,EAASG,UAAYH,EAASI,UAAY,MACxE,MACEd,EAAYmB,cAAgB,OAE9B,OAAOnB,IAGT,OAAOoB,QAAQC,IAAIJ,IAGfK,EAAsBnB,UAC1BlC,EAAQ5B,OAAQ,EAChB,IAEE,IAAImE,EAGFA,EAFE9E,EAAc,CAAC,kBAEA,QAAoBF,EAAOa,aAG3B,QAAmB,IAC/BP,EACHyF,KAAMrD,EAAWC,QACjBqD,SAAUtD,EAAWX,OAKzB,IAAIyD,EAAeR,EAASpF,MAAM4F,cAAgBR,EAASpF,MAAQ,GAGnE4F,QAAqBD,EAA8BC,GAEnDvE,EAAgBJ,MAAQ2E,EACxB9C,EAAWE,MAAQoC,EAASpF,MAAMgD,OAAS3B,EAAgBJ,MAAMoF,MACnE,CAAE,MAAOb,GACPP,QAAQO,MAAM,YAAaA,GAC3B,KAAUA,MAAM,cAAgBA,EAAMJ,UAAUpF,MAAMsG,SAAW,QACnE,CAAE,QACAzD,EAAQ5B,OAAQ,CAClB,GAGIE,EAAe,KACnB2B,EAAWC,QAAU,EACrBmD,KAGI9E,EAAc,KAClBmF,OAAOC,OAAO9F,EAAY,CACxBG,MAAO,GACPN,KAAM,GACNW,OAAQ,KAEVC,KAGIX,EAAe,KACnBuD,EAAO0C,KAAK,mCAGRrE,EAAcwC,IAClBb,EAAO0C,KAAK,2BAA2B7B,EAAY9E,OAG/CwC,EAAcsC,IAClBb,EAAO0C,KAAK,2BAA2B7B,EAAY9E,YAG/C0C,EAAiBoC,IACrBvB,EAAmBpC,MAAQ2D,EAC3BnB,EAAaC,UAAW,EACxBD,EAAaE,QAAU,GACvBP,EAAsBnC,OAAQ,GAI1BuC,EAAiBuB,UACrB,IAAK1B,EAAmBpC,MAAO,OAG/B,MAAMyF,EAAsD,YAApCrD,EAAmBpC,MAAMC,OAC3CyF,EAAsD,kBAApCtD,EAAmBpC,MAAMC,OAGjD,GAAKwF,IAAoBpG,EAAc,CAAC,aACnCqG,IAAoBrG,EAAc,CAAC,UAEtC,YADA,KAAUsG,QAAQ,cAIpB,MAAMjH,EAAM+G,EACR,iBAAiBrD,EAAmBpC,MAAMnB,mBAC1C,iBAAiBuD,EAAmBpC,MAAMnB,mBAE9C,IACE,MAAMsF,QAAiBC,EAAA,EAAQwB,KAAKlH,EAAK8D,GACzC,KAAUqD,QAAQ1B,GAAU2B,KAAO,UACnC3D,EAAsBnC,OAAQ,EAC9BiF,GACF,CAAE,MAAOV,GACP,KAAUA,MAAMA,EAAMJ,UAAUpF,MAAM+G,KAAO,SAC/C,GAIIxD,EAAsB,KAC1BH,EAAsBnC,OAAQ,EAC9BoC,EAAmBpC,MAAQ,MAGvB2B,EAAgBgC,IACpB,IAAaoC,QAAQ,aAAc,OAAQ,CACzCC,kBAAmB,KACnBC,iBAAkB,KAClB3G,KAAM,YACL4G,KAAKpC,UACN,UACQ,QAAkBH,EAAY9E,IACpC,KAAUgH,QAAQ,QAClBZ,GACF,CAAE,MAAOV,GACPP,QAAQO,MAAM,UAAWA,GACzB,KAAUA,MAAM,UAAYA,EAAMJ,UAAUpF,MAAMsG,SAAW,QAC/D,KAIEpD,EAAoBf,IACxBW,EAAWX,KAAOA,EAClB+D,KAGI/C,EAAuBJ,IAC3BD,EAAWC,QAAUA,EACrBmD,KAOF,OAJA,QAAU,KACRA,MAGK,CACLrD,UACAxB,kBACAX,aACAoC,aACAxC,gBACAsB,cACAH,aACAM,eACAF,cACAI,gBACAD,eACAK,UACAE,aACAI,YACAF,wBACAW,wBACAC,qBACAI,eACAtC,eACAC,cACAZ,eACA4B,aACAE,aACAE,gBACAgB,iBACAD,sBACAX,eACAM,mBACAC,sBAEJ,G,UCjgBF,MAAMiE,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://academic-management-frontend/./src/api/achievement.js","webpack://academic-management-frontend/./src/views/achievement/AchievementList.vue","webpack://academic-management-frontend/./src/views/achievement/AchievementList.vue?1c63"],"sourcesContent":["import request from './request'\n\n// 获取成果列表\nexport function getAchievementList(params = {}) {\n  return request({\n    url: '/achievements',\n    method: 'get',\n    params\n  })\n}\n\n// 获取成果详情\nexport function getAchievementById(id) {\n  return request({\n    url: `/achievements/${id}`,\n    method: 'get'\n  })\n}\n\n// 创建成果\nexport function createAchievement(data) {\n  return request({\n    url: '/achievements',\n    method: 'post',\n    data\n  })\n}\n\n// 更新成果\nexport function updateAchievement(id, data) {\n  return request({\n    url: `/achievements/${id}`,\n    method: 'put',\n    data\n  })\n}\n\n// 删除成果\nexport function deleteAchievement(id) {\n  return request({\n    url: `/achievements/${id}`,\n    method: 'delete'\n  })\n}\n\n// 根据类型获取成果\nexport function getAchievementsByType(type) {\n  return request({\n    url: `/achievements/type/${type}`,\n    method: 'get'\n  })\n}\n\n// 根据级别获取成果\nexport function getAchievementsByLevel(level) {\n  return request({\n    url: `/achievements/level/${level}`,\n    method: 'get'\n  })\n}\n\n// 获取用户的成果列表\nexport function getUserAchievements(userId) {\n  return request({\n    url: `/achievements/submitter/${userId}`,\n    method: 'get'\n  })\n}\n\n// 上传成果文件\nexport function uploadAchievementFile(formData) {\n  return request({\n    url: '/achievements/upload-file',\n    method: 'post',\n    data: formData,\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    }\n  })\n}","<template>\r\n  <div class=\"achievement-list\">\r\n    <div class=\"page-header\">\r\n      <h1>成果申报</h1>\r\n      <el-button \r\n        type=\"primary\" \r\n        @click=\"handleCreate\"\r\n        v-if=\"hasPermission(['STUDENT'])\"\r\n      >\r\n        <el-icon><Plus /></el-icon>\r\n        申报成果\r\n      </el-button>\r\n    </div>\r\n\r\n    <!-- 搜索栏 -->\r\n    <div class=\"search-container\">\r\n      <el-form :model=\"searchForm\" inline>\r\n        <el-form-item label=\"成果标题\">\r\n          <el-input \r\n            v-model=\"searchForm.title\" \r\n            placeholder=\"请输入成果标题\"\r\n            clearable\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"成果类型\">\r\n          <el-select v-model=\"searchForm.type\" style=\"width: 120px\" placeholder=\"请选择类型\" clearable>\r\n            <el-option label=\"论文\" value=\"PAPER\" />\r\n            <el-option label=\"专利\" value=\"PATENT\" />\r\n            <el-option label=\"证书\" value=\"CERTIFICATE\" />\r\n            <el-option label=\"项目\" value=\"PROJECT\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"审核状态\">\r\n          <el-select v-model=\"searchForm.status\" style=\"width: 120px\" placeholder=\"请选择状态\" clearable>\r\n            <el-option label=\"待审核\" value=\"PENDING\" />\r\n            <el-option label=\"待终审\" value=\"PENDING_FINAL\" />\r\n            <el-option label=\"已通过\" value=\"APPROVED\" />\r\n            <el-option label=\"已驳回\" value=\"REJECTED\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"handleSearch\">\r\n            <el-icon><Search /></el-icon>\r\n            搜索\r\n          </el-button>\r\n          <el-button @click=\"handleReset\">\r\n            <el-icon><Refresh /></el-icon>\r\n            重置\r\n          </el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n\r\n    <!-- 成果列表 -->\r\n    <div class=\"table-container\">\r\n      <el-table :data=\"achievementList\" v-loading=\"loading\">\r\n        <el-table-column prop=\"title\" label=\"成果标题\" min-width=\"150\" />\r\n        <el-table-column prop=\"type\" label=\"类型\" width=\"130\">\r\n          <template #default=\"scope\">\r\n            <el-tag :type=\"getTypeTag(scope.row.type)\">\r\n              {{ getTypeName(scope.row.type) }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"level\" label=\"级别\" width=\"120\">\r\n          <template #default=\"scope\">\r\n            <el-tag v-if=\"scope.row.level\" :type=\"getLevelTag(scope.row.level)\">\r\n              {{ getLevelName(scope.row.level) }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"submitterName\" label=\"提交者\" width=\"120\" />\r\n        <el-table-column prop=\"createTime\" label=\"提交时间\" width=\"180\" />\r\n        <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\r\n          <template #default=\"scope\">\r\n            <el-tag :type=\"getStatusTag(scope.row.status)\">\r\n              {{ getStatusName(scope.row.status) }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\" width=\"200\" fixed=\"right\">\r\n          <template #default=\"scope\">\r\n            <el-button \r\n              type=\"primary\" \r\n              size=\"small\" \r\n              @click=\"handleView(scope.row)\"\r\n            >\r\n              查看\r\n            </el-button>\r\n            <el-button \r\n              type=\"warning\" \r\n              size=\"small\" \r\n              @click=\"handleEdit(scope.row)\"\r\n              v-if=\"canEdit(scope.row)\"\r\n            >\r\n              编辑\r\n            </el-button>\r\n            <!-- 教师显示审核按钮，管理员显示待初审或终审按钮 -->\r\n            <el-button \r\n              type=\"success\" \r\n              size=\"small\" \r\n              @click=\"handleApprove(scope.row)\"\r\n              v-if=\"canApprove(scope.row)\"\r\n            >\r\n              {{ getApprovalButtonText(scope.row) }}\r\n            </el-button>\r\n            <!-- 管理员显示待初审按钮（不可点击） -->\r\n            <el-button \r\n              type=\"info\" \r\n              size=\"small\" \r\n              disabled\r\n              v-if=\"hasPermission(['ADMIN']) && scope.row.status === 'PENDING' && !canApprove(scope.row)\"\r\n            >\r\n              待初审\r\n            </el-button>\r\n            <el-button \r\n              type=\"danger\" \r\n              size=\"small\" \r\n              @click=\"handleDelete(scope.row)\"\r\n              v-if=\"canDelete(scope.row)\"\r\n            >\r\n              删除\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <!-- 分页 -->\r\n      <div class=\"pagination-container\">\r\n        <el-pagination\r\n          v-model:current-page=\"pagination.current\"\r\n          v-model:page-size=\"pagination.size\"\r\n          :total=\"pagination.total\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n        />\r\n      </div>\r\n      \r\n      <!-- 审核弹窗 -->\r\n      <el-dialog\r\n        v-model=\"approvalDialogVisible\"\r\n        :title=\"`${currentAchievement?.status === 'PENDING' ? '初审' : '终审'}成果: ${currentAchievement?.title}`\"\r\n        width=\"500px\"\r\n        class=\"approval-dialog\"\r\n      >\r\n        <div v-if=\"currentAchievement\">\r\n          <el-form\r\n            :model=\"approvalForm\"\r\n            label-width=\"80px\"\r\n          >\r\n            <el-form-item label=\"审核结果\">\r\n              <el-radio-group v-model=\"approvalForm.approved\">\r\n                <el-radio :label=\"true\">通过</el-radio>\r\n                <el-radio :label=\"false\">驳回</el-radio>\r\n              </el-radio-group>\r\n            </el-form-item>\r\n            \r\n            <el-form-item label=\"审核意见\">\r\n              <el-input\r\n                v-model=\"approvalForm.comment\"\r\n                type=\"textarea\"\r\n                :rows=\"4\"\r\n                placeholder=\"请输入审核意见\"\r\n              />\r\n            </el-form-item>\r\n          </el-form>\r\n        </div>\r\n        \r\n        <template #footer>\r\n          <div class=\"dialog-footer\">\r\n            <el-button @click=\"closeApprovalDialog\">取消</el-button>\r\n            <el-button type=\"primary\" @click=\"submitApproval\">确认</el-button>\r\n          </div>\r\n        </template>\r\n      </el-dialog>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, onMounted, computed } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { useStore } from 'vuex'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { getAchievementList, getUserAchievements, deleteAchievement } from '@/api/achievement'\r\nimport request from '@/api/request'\r\n\r\nexport default {\r\n  name: 'AchievementList',\r\n  setup() {\r\n    const router = useRouter()\r\n    const store = useStore()\r\n    \r\n    const loading = ref(false)\r\n    const achievementList = ref([])\r\n    const userCache = ref(new Map()) // 用于缓存用户信息，避免重复请求\r\n    \r\n    const searchForm = reactive({\r\n      title: '',\r\n      type: '',\r\n      status: ''\r\n    })\r\n    \r\n    const pagination = reactive({\r\n      current: 1,\r\n      size: 10,\r\n      total: 0\r\n    })\r\n    \r\n    const userRole = computed(() => store.getters.userRole)\r\n    const userId = computed(() => store.getters.user?.id)\r\n    \r\n    // 审核弹窗相关\r\n    const approvalDialogVisible = ref(false)\r\n    const currentAchievement = ref(null)\r\n    const approvalForm = reactive({\r\n      approved: true,\r\n      comment: ''\r\n    })\r\n    \r\n    const hasPermission = (roles) => {\r\n      return roles.includes(userRole.value)\r\n    }\r\n    \r\n    const getTypeName = (type) => {\r\n      const typeMap = {\r\n        'PAPER': '论文',\r\n        'PATENT': '专利',\r\n        'CERTIFICATE': '证书',\r\n        'PROJECT': '项目'\r\n      }\r\n      return typeMap[type] || type\r\n    }\r\n    \r\n    const getTypeTag = (type) => {\r\n      const tagMap = {\r\n        'PAPER': 'primary',\r\n        'PATENT': 'success',\r\n        'CERTIFICATE': 'warning',\r\n        'PROJECT': 'info'\r\n      }\r\n      return tagMap[type] || 'info'\r\n    }\r\n    \r\n    const getLevelName = (level) => {\r\n      const levelMap = {\r\n        'NATIONAL': '国家级',\r\n        'PROVINCIAL': '省级',\r\n        'SCHOOL': '校级'\r\n      }\r\n      return levelMap[level] || level\r\n    }\r\n    \r\n    const getLevelTag = (level) => {\r\n      const tagMap = {\r\n        'NATIONAL': 'danger',\r\n        'PROVINCIAL': 'warning',\r\n        'SCHOOL': 'success'\r\n      }\r\n      return tagMap[level] || 'info'\r\n    }\r\n    \r\n    const getStatusName = (status) => {\r\n      const statusMap = {\r\n        'PENDING': '待审核',\r\n        'PENDING_FINAL': '待终审',\r\n        'APPROVED': '已通过',\r\n        'REJECTED': '已驳回'\r\n      }\r\n      return statusMap[status] || status\r\n    }\r\n    \r\n    const getStatusTag = (status) => {\r\n      const tagMap = {\r\n        'PENDING': 'warning',\r\n        'PENDING_FINAL': 'success',\r\n        'APPROVED': 'success',\r\n        'REJECTED': 'danger'\r\n      }\r\n      return tagMap[status] || 'info'\r\n    }\r\n    \r\n    const canEdit = (achievement) => {\r\n      return hasPermission(['STUDENT']) && \r\n             achievement.submitterId === userId.value && \r\n             achievement.status === 'PENDING'\r\n    }\r\n    \r\n    const canApprove = (achievement) => {\r\n      // 教师可以初审\r\n      if (hasPermission(['TEACHER']) && achievement.status === 'PENDING') {\r\n        return true\r\n      }\r\n      // 管理员只能终审，不能初审\r\n      if (hasPermission(['ADMIN']) && achievement.status === 'PENDING_FINAL') {\r\n        return true\r\n      }\r\n      return false\r\n    }\r\n    \r\n    // 获取审核按钮文本\r\n    const getApprovalButtonText = (achievement) => {\r\n      if (achievement.status === 'PENDING') {\r\n        return userRole.value === 'TEACHER' ? '审核' : '待初审'\r\n      }\r\n      if (achievement.status === 'PENDING_FINAL' && hasPermission(['ADMIN'])) {\r\n        return '终审'\r\n      }\r\n      return '审核'\r\n    }\r\n    \r\n    const canDelete = (achievement) => {\r\n      return hasPermission(['STUDENT']) && \r\n             achievement.submitterId === userId.value && \r\n             achievement.status === 'PENDING'\r\n    }\r\n    \r\n    // 获取用户详情并缓存结果\r\n    const fetchUserDetail = async (userId) => {\r\n      // 检查缓存中是否已有该用户信息\r\n      if (userCache.value.has(userId)) {\r\n        console.log(`从缓存中获取的用户信息:`, userCache.value.get(userId))\r\n        return userCache.value.get(userId)\r\n      }\r\n      \r\n      try {\r\n        console.log(`开始获取用户${userId}信息`)\r\n        const response = await request.get(`/users/basic/${userId}`)\r\n        console.log(`获取用户${userId}信息成功:`, response)\r\n        const userInfo = response?.data || response\r\n        userCache.value.set(userId, userInfo)\r\n        return userInfo\r\n      } catch (error) {\r\n        console.error(`获取用户${userId}信息失败:`, error)\r\n        // 返回默认值，避免影响整个列表显示\r\n        return { realName: '未知用户', username: '未知用户' }\r\n      }\r\n    }\r\n    \r\n    // 为成果列表中的每个成果获取提交者姓名\r\n    const enrichAchievementWithUserInfo = async (achievements) => {\r\n      const promises = achievements.map(async (achievement) => {\r\n        if (achievement.submitterId) {\r\n          const userInfo = await fetchUserDetail(achievement.submitterId)\r\n          // 将submitterName设置为用户的真实姓名\r\n          achievement.submitterName = userInfo.realName || userInfo.username || '未知用户'\r\n        } else {\r\n          achievement.submitterName = '未知用户'\r\n        }\r\n        return achievement\r\n      })\r\n      \r\n      return Promise.all(promises)\r\n    }\r\n    \r\n    const loadAchievementList = async () => {\r\n      loading.value = true\r\n      try {\r\n        // 根据用户角色调用不同的API\r\n        let response\r\n        if (hasPermission(['STUDENT'])) {\r\n          // 学生只能查看自己的成果\r\n          response = await getUserAchievements(userId.value)\r\n        } else {\r\n          // 教师和管理员可以查看所有成果，并支持搜索和分页\r\n          response = await getAchievementList({\r\n            ...searchForm,\r\n            page: pagination.current,\r\n            pageSize: pagination.size\r\n          })\r\n        }\r\n        \r\n        // 获取成果数据\r\n        let achievements = response.data?.achievements || response.data || []\r\n        \r\n        // 为每个成果获取提交者的真实姓名\r\n        achievements = await enrichAchievementWithUserInfo(achievements)\r\n        \r\n        achievementList.value = achievements\r\n        pagination.total = response.data?.total || achievementList.value.length\r\n      } catch (error) {\r\n        console.error('加载成果列表失败:', error)\r\n        ElMessage.error('加载成果列表失败: ' + (error.response?.data?.message || '未知错误'))\r\n      } finally {\r\n        loading.value = false\r\n      }\r\n    }\r\n    \r\n    const handleSearch = () => {\r\n      pagination.current = 1\r\n      loadAchievementList()\r\n    }\r\n    \r\n    const handleReset = () => {\r\n      Object.assign(searchForm, {\r\n        title: '',\r\n        type: '',\r\n        status: ''\r\n      })\r\n      handleSearch()\r\n    }\r\n    \r\n    const handleCreate = () => {\r\n      router.push('/dashboard/achievements/create')\r\n    }\r\n    \r\n    const handleView = (achievement) => {\r\n      router.push(`/dashboard/achievements/${achievement.id}`)\r\n    }\r\n    \r\n    const handleEdit = (achievement) => {\r\n      router.push(`/dashboard/achievements/${achievement.id}/edit`)\r\n    }\r\n    \r\n    const handleApprove = (achievement) => {\r\n      currentAchievement.value = achievement\r\n      approvalForm.approved = true\r\n      approvalForm.comment = ''\r\n      approvalDialogVisible.value = true\r\n    }\r\n    \r\n    // 提交审核\r\n    const submitApproval = async () => {\r\n      if (!currentAchievement.value) return\r\n      \r\n      // 根据状态决定是初审还是终审\r\n      const isFirstApproval = currentAchievement.value.status === 'PENDING'\r\n      const isFinalApproval = currentAchievement.value.status === 'PENDING_FINAL'\r\n      \r\n      // 验证权限：只有教师可以初审，只有管理员可以终审\r\n      if ((isFirstApproval && !hasPermission(['TEACHER'])) || \r\n          (isFinalApproval && !hasPermission(['ADMIN']))) {\r\n        ElMessage.warning('您没有权限执行此操作')\r\n        return\r\n      }\r\n      \r\n      const url = isFirstApproval \r\n        ? `/achievements/${currentAchievement.value.id}/first-approve`\r\n        : `/achievements/${currentAchievement.value.id}/final-approve`\r\n      \r\n      try {\r\n        const response = await request.post(url, approvalForm)\r\n        ElMessage.success(response?.msg || '审核操作成功')\r\n        approvalDialogVisible.value = false\r\n        loadAchievementList() // 重新加载列表\r\n      } catch (error) {\r\n        ElMessage.error(error.response?.data?.msg || '审核操作失败')\r\n      }\r\n    }\r\n    \r\n    // 关闭审核弹窗\r\n    const closeApprovalDialog = () => {\r\n      approvalDialogVisible.value = false\r\n      currentAchievement.value = null\r\n    }\r\n    \r\n    const handleDelete = (achievement) => {\r\n      ElMessageBox.confirm('确定要删除此成果吗？', '确认删除', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(async () => {\r\n        try {\r\n          await deleteAchievement(achievement.id)\r\n          ElMessage.success('删除成功')\r\n          loadAchievementList()\r\n        } catch (error) {\r\n          console.error('删除成果失败:', error)\r\n          ElMessage.error('删除失败: ' + (error.response?.data?.message || '未知错误'))\r\n        }\r\n      })\r\n    }\r\n    \r\n    const handleSizeChange = (size) => {\r\n      pagination.size = size\r\n      loadAchievementList()\r\n    }\r\n    \r\n    const handleCurrentChange = (current) => {\r\n      pagination.current = current\r\n      loadAchievementList()\r\n    }\r\n    \r\n    onMounted(() => {\r\n      loadAchievementList()\r\n    })\r\n    \r\n    return {\r\n      loading,\r\n      achievementList,\r\n      searchForm,\r\n      pagination,\r\n      hasPermission,\r\n      getTypeName,\r\n      getTypeTag,\r\n      getLevelName,\r\n      getLevelTag,\r\n      getStatusName,\r\n      getStatusTag,\r\n      canEdit,\r\n      canApprove,\r\n      canDelete,\r\n      getApprovalButtonText,\r\n      approvalDialogVisible,\r\n      currentAchievement,\r\n      approvalForm,\r\n      handleSearch,\r\n      handleReset,\r\n      handleCreate,\r\n      handleView,\r\n      handleEdit,\r\n      handleApprove,\r\n      submitApproval,\r\n      closeApprovalDialog,\r\n      handleDelete,\r\n      handleSizeChange,\r\n      handleCurrentChange\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.achievement-list {\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.page-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.page-header h1 {\r\n  margin: 0;\r\n  color: #2c3e50;\r\n}\r\n\r\n.search-container {\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n  padding: 20px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.table-container {\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n  padding: 20px;\r\n}\r\n\r\n.pagination-container {\r\n  margin-top: 20px;\r\n  text-align: right;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n}\r\n\r\n.approval-dialog .el-dialog__header {\r\n  background-color: #f5f7fa;\r\n  padding: 20px 25px 15px;\r\n}\r\n\r\n.approval-dialog .el-dialog__body {\r\n  padding: 20px 25px;\r\n}\r\n\r\n.approval-dialog .dialog-footer {\r\n  margin-top: 20px;\r\n  text-align: right;\r\n}\r\n</style>\r\n","import { render } from \"./AchievementList.vue?vue&type=template&id=10637df6&scoped=true\"\nimport script from \"./AchievementList.vue?vue&type=script&lang=js\"\nexport * from \"./AchievementList.vue?vue&type=script&lang=js\"\n\nimport \"./AchievementList.vue?vue&type=style&index=0&id=10637df6&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-10637df6\"]])\n\nexport default __exports__"],"names":["getAchievementList","params","url","method","getAchievementById","id","createAchievement","data","updateAchievement","deleteAchievement","getUserAchievements","userId","class","hasPermission","type","handleCreate","model","searchForm","inline","label","title","placeholder","clearable","style","value","status","handleSearch","handleReset","achievementList","prop","width","default","getTypeTag","scope","row","getTypeName","getLevelTag","level","getLevelName","getStatusTag","getStatusName","fixed","size","handleView","canEdit","handleEdit","canApprove","handleApprove","getApprovalButtonText","disabled","canDelete","handleDelete","loading","pagination","current","total","layout","handleSizeChange","handleCurrentChange","approvalDialogVisible","currentAchievement","footer","closeApprovalDialog","submitApproval","approvalForm","approved","comment","rows","name","setup","router","store","userCache","Map","userRole","getters","user","roles","includes","typeMap","tagMap","levelMap","statusMap","achievement","submitterId","fetchUserDetail","async","has","console","log","get","response","request","userInfo","set","error","realName","username","enrichAchievementWithUserInfo","achievements","promises","map","submitterName","Promise","all","loadAchievementList","page","pageSize","length","message","Object","assign","push","isFirstApproval","isFinalApproval","warning","post","success","msg","confirm","confirmButtonText","cancelButtonText","then","__exports__","render"],"sourceRoot":""}