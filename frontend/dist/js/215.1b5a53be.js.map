{"version":3,"file":"js/215.1b5a53be.js","mappings":"4QAGO,SAASA,EAAMC,GACpB,OAAO,OAAQ,CACbC,IAAK,cACLC,OAAQ,OACRF,QAEJ,CAGO,SAASG,EAASH,GACvB,OAAO,OAAQ,CACbC,IAAK,iBACLC,OAAQ,OACRF,QAEJ,CAWO,SAASI,EAAeJ,GAC7B,OAAO,OAAQ,CACbC,IAAK,wBACLC,OAAQ,OACRF,QAEJ,CAGO,SAASK,EAAcL,GAC5B,OAAO,OAAQ,CACbC,IAAK,uBACLC,OAAQ,OACRF,QAEJ,C,4GC3COM,MAAM,W,GAKJA,MAAM,mB,GAIAA,MAAM,gB,GA4DNA,MAAM,e,GACJA,MAAM,kB,GAIJA,MAAM,a,GAMRA,MAAM,iB,GAEJA,MAAM,a,GAEHA,MAAM,c,GAETA,MAAM,a,GAEHA,MAAM,c,GAETA,MAAM,a,GAEHA,MAAM,c,GAQjBA,MAAM,iB,sQApGf,QA8IM,MA9IN,EA8IM,C,eA7IJ,QAEM,OAFDA,MAAM,eAAa,EACtB,QAAa,UAAT,U,KAGN,QAwIM,MAxIN,EAwIM,EAvIJ,QA2FS,GA3FAC,OAAQ,IAAE,C,iBAEjB,IAyDS,EAzDT,QAyDS,GAzDAC,KAAM,IAAE,C,iBACf,IAuDM,EAvDN,QAuDM,MAvDN,EAuDM,C,eAtDJ,QAAa,UAAT,QAAI,KACR,QAoDU,GAnDRC,IAAI,UACHC,MAAO,EAAAC,SACPC,MAAO,EAAAA,MACR,cAAY,QACX,UAAM,QAAU,EAAAC,aAAY,c,kBAE7B,IAEe,EAFf,QAEe,GAFDC,MAAM,MAAMC,KAAK,Y,kBAC7B,IAAiD,EAAjD,QAAiD,G,WAA9B,EAAAJ,SAASK,S,qCAAT,EAAAL,SAAiB,YAAEM,SAAA,I,gCAGxC,QAEe,GAFDH,MAAM,OAAOC,KAAK,Y,kBAC9B,IAAwC,EAAxC,QAAwC,G,WAArB,EAAAJ,SAASO,S,qCAAT,EAAAP,SAAiB,a,gCAGtC,QAEe,GAFDG,MAAM,KAAKC,KAAK,S,kBAC5B,IAAqC,EAArC,QAAqC,G,WAAlB,EAAAJ,SAASQ,M,qCAAT,EAAAR,SAAc,U,gCAGnC,QAEe,GAFDG,MAAM,MAAMC,KAAK,S,kBAC7B,IAAqC,EAArC,QAAqC,G,WAAlB,EAAAJ,SAASS,M,qCAAT,EAAAT,SAAc,U,gCAGnC,QAEe,GAFDG,MAAM,QAAQC,KAAK,a,kBAC/B,IAAyC,EAAzC,QAAyC,G,WAAtB,EAAAJ,SAASU,U,qCAAT,EAAAV,SAAkB,c,gCAGvC,QAEe,GAFDG,MAAM,KAAKC,KAAK,c,kBAC5B,IAA0C,EAA1C,QAA0C,G,WAAvB,EAAAJ,SAASW,W,qCAAT,EAAAX,SAAmB,e,gCAGxC,QAEe,GAFDG,MAAM,KAAKC,KAAK,S,kBAC5B,IAAqC,EAArC,QAAqC,G,WAAlB,EAAAJ,SAASY,M,qCAAT,EAAAZ,SAAc,U,gCAGnC,QAEe,GAFDG,MAAM,KAAKC,KAAK,S,kBAC5B,IAAqC,EAArC,QAAqC,G,WAAlB,EAAAJ,SAASa,M,qCAAT,EAAAb,SAAc,U,gCAGnC,QAKe,GALDG,MAAM,KAAKC,KAAK,U,kBAC5B,IAGiB,EAHjB,QAGiB,G,WAHQ,EAAAJ,SAASc,O,qCAAT,EAAAd,SAAe,W,kBACtC,IAAiC,EAAjC,QAAiC,GAAtBG,MAAO,GAAC,C,iBAAE,IAAC,oB,QAAD,KAAC,O,OACtB,QAAiC,GAAtBA,MAAO,GAAC,C,iBAAE,IAAC,oB,QAAD,KAAC,O,wCAI1B,QAKe,Q,iBAJb,IAEY,EAFZ,QAEY,GAFDY,KAAK,UAAWC,QAAS,EAAAA,QAAU,QAAO,EAAAd,c,kBAAc,IAEnE,oB,QAFmE,UAEnE,O,+BACA,QAA8C,GAAlC,QAAO,EAAAe,aAAW,C,iBAAE,IAAE,oB,QAAF,MAAE,O,8EAO1C,QA4BS,GA5BApB,KAAM,GAAC,C,iBACd,IA0BM,EA1BN,QA0BM,MA1BN,EA0BM,EAzBJ,QAQM,MARN,EAQM,EAPJ,QAEY,GAFAqB,KAAM,IAAMC,IAAK,EAAAnB,SAASoB,Q,kBACpC,IAA2D,E,iBAAxD,EAAApB,SAASO,SAAW,EAAAP,SAASO,SAASc,OAAO,GAAK,KAAN,K,iBAEjD,QAGM,MAHN,EAGM,EAFJ,QAAqD,mBAA9C,EAAArB,SAASO,UAAY,EAAAP,SAASK,UAAQ,IAC7C,QAAkC,kBAA5B,EAAAiB,YAAY,EAAAC,WAAQ,QAI9B,QAcM,MAdN,EAcM,C,eAbJ,QAAa,UAAT,QAAI,KACR,QAGM,MAHN,EAGM,C,eAFJ,QAAoC,QAA9B5B,MAAM,cAAa,QAAI,KAC7B,QAA0D,OAA1D,GAA0D,QAA9B,EAAA6B,UAAUC,YAAU,MAElD,QAGM,MAHN,EAGM,C,eAFJ,QAAoC,QAA9B9B,MAAM,cAAa,QAAI,KAC7B,QAA4D,OAA5D,GAA4D,QAAhC,EAAA6B,UAAUE,cAAY,MAEpD,QAGM,MAHN,EAGM,C,eAFJ,QAAoC,QAA9B/B,MAAM,cAAa,QAAI,KAC7B,QAAwD,OAAxD,GAAwD,QAA5B,EAAA6B,UAAUG,UAAQ,W,eAQxD,QAwCM,MAxCN,EAwCM,C,eAvCJ,QAAa,UAAT,QAAI,KACR,QAqCU,GApCR7B,IAAI,kBACHC,MAAO,EAAA6B,aACP3B,MAAO,EAAA4B,cACR,cAAY,QACX,UAAM,QAAU,EAAAC,qBAAoB,c,kBAErC,IAMe,EANf,QAMe,GAND3B,MAAM,MAAMC,KAAK,e,kBAC7B,IAIE,EAJF,QAIE,G,WAHS,EAAAwB,aAAaG,Y,qCAAb,EAAAH,aAAwB,eACjCb,KAAK,WACL,oB,gCAIJ,QAMe,GANDZ,MAAM,MAAMC,KAAK,e,kBAC7B,IAIE,EAJF,QAIE,G,WAHS,EAAAwB,aAAaI,Y,uCAAb,EAAAJ,aAAwB,eACjCb,KAAK,WACL,oB,gCAIJ,QAMe,GANDZ,MAAM,OAAOC,KAAK,mB,kBAC9B,IAIE,EAJF,QAIE,G,WAHS,EAAAwB,aAAaK,gB,uCAAb,EAAAL,aAA4B,mBACrCb,KAAK,WACL,oB,gCAIJ,QAKe,Q,iBAJb,IAEY,EAFZ,QAEY,GAFDA,KAAK,UAAWC,QAAS,EAAAkB,gBAAkB,QAAO,EAAAJ,sB,kBAAsB,IAEnF,oB,QAFmF,UAEnF,O,+BACA,QAAsD,GAA1C,QAAO,EAAAK,qBAAmB,C,iBAAE,IAAE,oB,QAAF,MAAE,O,6HAetD,GACEC,KAAM,UACN,KAAAC,GACE,MAAMC,GAAQ,UAERC,GAAU,UACVC,GAAkB,UAClBxB,GAAU,SAAI,GACdkB,GAAkB,SAAI,GAEtBO,GAAO,QAAS,IAAMH,EAAMI,QAAQD,MACpClB,GAAW,QAAS,IAAMe,EAAMI,QAAQnB,UAExCvB,GAAW,QAAS,CACxBK,SAAU,GACVE,SAAU,GACVC,MAAO,GACPC,MAAO,GACPC,UAAW,GACXC,WAAY,GACZC,MAAO,GACPC,MAAO,GACPC,OAAQ,EACRM,OAAQ,KAGJQ,GAAe,QAAS,CAC5BG,YAAa,GACbC,YAAa,GACbC,gBAAiB,KAGbT,GAAY,QAAS,CACzBC,WAAY,EACZC,aAAc,EACdC,SAAU,IAGN1B,EAAQ,CACZM,SAAU,CACR,CAAEoC,UAAU,EAAMC,QAAS,UAAWC,QAAS,SAEjDrC,MAAO,CACL,CAAEmC,UAAU,EAAMC,QAAS,QAASC,QAAS,QAC7C,CAAE9B,KAAM,QAAS6B,QAAS,aAAcC,QAAS,SAEnDpC,MAAO,CACL,CAAEkC,UAAU,EAAMC,QAAS,SAAUC,QAAS,QAC9C,CAAEC,QAAS,gBAAiBF,QAAS,YAAaC,QAAS,UAIzDE,EAA0B,CAACC,EAAMC,EAAOC,KACxCD,IAAUrB,EAAaI,YACzBkB,EAAS,IAAIC,MAAM,eAEnBD,KAIErB,EAAgB,CACpBE,YAAa,CACX,CAAEY,UAAU,EAAMC,QAAS,SAAUC,QAAS,SAEhDb,YAAa,CACX,CAAEW,UAAU,EAAMC,QAAS,SAAUC,QAAS,QAC9C,CAAEO,IAAK,EAAGR,QAAS,aAAcC,QAAS,SAE5CZ,gBAAiB,CACf,CAAEU,UAAU,EAAMC,QAAS,SAAUC,QAAS,QAC9C,CAAEQ,UAAWN,EAAyBF,QAAS,UAI7CvB,EAAegC,IACnB,MAAMC,EAAU,CACd,QAAW,KACX,QAAW,KACX,MAAS,OAEX,OAAOA,EAAQD,IAASA,GAGpBE,EAAe,KACff,EAAKQ,OACPQ,OAAOC,OAAO1D,EAAU,CACtBK,SAAUoC,EAAKQ,MAAM5C,UAAY,GACjCE,SAAUkC,EAAKQ,MAAM1C,UAAY,GACjCC,MAAOiC,EAAKQ,MAAMzC,OAAS,GAC3BC,MAAOgC,EAAKQ,MAAMxC,OAAS,GAC3BC,UAAW+B,EAAKQ,MAAMvC,WAAa,GACnCC,WAAY8B,EAAKQ,MAAMtC,YAAc,GACrCC,MAAO6B,EAAKQ,MAAMrC,OAAS,GAC3BC,MAAO4B,EAAKQ,MAAMpC,OAAS,GAC3BC,OAAQ2B,EAAKQ,MAAMnC,QAAU,EAC7BM,OAAQqB,EAAKQ,MAAM7B,QAAU,MAK7BlB,EAAeyD,UACdpB,EAAQU,aAEPV,EAAQU,MAAMW,SAASD,MAAOE,IAClC,GAAIA,EAAO,CACT7C,EAAQiC,OAAQ,EAChB,UAEQ,QAAcjD,GAGpBsC,EAAMwB,SAAS,aAAc9D,GAC7B,KAAU+D,QAAQ,SACpB,CAAE,MAAOC,GACP,KAAUA,MAAM,UAAYA,EAAMC,UAAU5E,MAAMuD,SAAWoB,EAAMpB,SACrE,CAAE,QACA5B,EAAQiC,OAAQ,CAClB,CACF,KAIEhC,EAAc,KAClBuC,KAGI1B,EAAuB6B,UACtBnB,EAAgBS,aAEfT,EAAgBS,MAAMW,SAASD,MAAOE,IAC1C,GAAIA,EAAO,CACT3B,EAAgBe,OAAQ,EACxB,UAEQ,QAAe,CACnBlB,YAAaH,EAAaG,YAC1BC,YAAaJ,EAAaI,cAG5B,KAAU+B,QAAQ,UAElB5B,IAEA+B,WAAW,KACTC,EAAA,EAAOC,KAAK,WACX,IACL,CAAE,MAAOJ,GACP,KAAUA,MAAM,YAAcA,EAAMC,UAAU5E,MAAMuD,SAAWoB,EAAMpB,SACvE,CAAE,QACAV,EAAgBe,OAAQ,CAC1B,CACF,KAIEd,EAAsB,KACtBK,EAAgBS,OAClBT,EAAgBS,MAAMoB,eAQ1B,OAJA,QAAU,KACRb,MAGK,CACLjB,UACAC,kBACAxB,UACAkB,kBACAO,OACAlB,WACAvB,WACA4B,eACAJ,YACAvB,QACA4B,gBACAP,cACApB,eACAe,cACAa,uBACAK,sBAEJ,G,UCzUF,MAAMmC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://academic-management-frontend/./src/api/auth.js","webpack://academic-management-frontend/./src/views/user/Profile.vue","webpack://academic-management-frontend/./src/views/user/Profile.vue?c5c2"],"sourcesContent":["import request from './request'\r\n\r\n// 用户登录\r\nexport function login(data) {\r\n  return request({\r\n    url: '/auth/login',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n\r\n// 用户注册\r\nexport function register(data) {\r\n  return request({\r\n    url: '/auth/register',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n\r\n// 获取用户信息\r\nexport function getUserInfo() {\r\n  return request({\r\n    url: '/auth/userinfo',\r\n    method: 'get'\r\n  })\r\n}\r\n\r\n// 修改密码\r\nexport function changePassword(data) {\r\n  return request({\r\n    url: '/auth/change-password',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n\r\n// 更新用户信息\r\nexport function updateProfile(data) {\r\n  return request({\r\n    url: '/auth/update-profile',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n","<template>\r\n  <div class=\"profile\">\r\n    <div class=\"page-header\">\r\n      <h1>个人中心</h1>\r\n    </div>\r\n\r\n    <div class=\"profile-content\">\r\n      <el-row :gutter=\"20\">\r\n        <!-- 个人信息 -->\r\n        <el-col :span=\"16\">\r\n          <div class=\"profile-card\">\r\n            <h3>个人信息</h3>\r\n            <el-form\r\n              ref=\"formRef\"\r\n              :model=\"userForm\"\r\n              :rules=\"rules\"\r\n              label-width=\"120px\"\r\n              @submit.prevent=\"handleUpdate\"\r\n            >\r\n              <el-form-item label=\"用户名\" prop=\"username\">\r\n                <el-input v-model=\"userForm.username\" disabled />\r\n              </el-form-item>\r\n              \r\n              <el-form-item label=\"真实姓名\" prop=\"realName\">\r\n                <el-input v-model=\"userForm.realName\" />\r\n              </el-form-item>\r\n              \r\n              <el-form-item label=\"邮箱\" prop=\"email\">\r\n                <el-input v-model=\"userForm.email\" />\r\n              </el-form-item>\r\n              \r\n              <el-form-item label=\"手机号\" prop=\"phone\">\r\n                <el-input v-model=\"userForm.phone\" />\r\n              </el-form-item>\r\n              \r\n              <el-form-item label=\"学号/工号\" prop=\"studentId\">\r\n                <el-input v-model=\"userForm.studentId\" />\r\n              </el-form-item>\r\n              \r\n              <el-form-item label=\"院系\" prop=\"department\">\r\n                <el-input v-model=\"userForm.department\" />\r\n              </el-form-item>\r\n              \r\n              <el-form-item label=\"专业\" prop=\"major\">\r\n                <el-input v-model=\"userForm.major\" />\r\n              </el-form-item>\r\n              \r\n              <el-form-item label=\"年级\" prop=\"grade\">\r\n                <el-input v-model=\"userForm.grade\" />\r\n              </el-form-item>\r\n              \r\n              <el-form-item label=\"性别\" prop=\"gender\">\r\n                <el-radio-group v-model=\"userForm.gender\">\r\n                  <el-radio :label=\"1\">男</el-radio>\r\n                  <el-radio :label=\"2\">女</el-radio>\r\n                </el-radio-group>\r\n              </el-form-item>\r\n              \r\n              <el-form-item>\r\n                <el-button type=\"primary\" :loading=\"loading\" @click=\"handleUpdate\">\r\n                  更新信息\r\n                </el-button>\r\n                <el-button @click=\"handleReset\">重置</el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n          </div>\r\n        </el-col>\r\n        \r\n        <!-- 头像和统计 -->\r\n        <el-col :span=\"8\">\r\n          <div class=\"avatar-card\">\r\n            <div class=\"avatar-section\">\r\n              <el-avatar :size=\"120\" :src=\"userForm.avatar\">\r\n                {{ userForm.realName ? userForm.realName.charAt(0) : 'U' }}\r\n              </el-avatar>\r\n              <div class=\"user-info\">\r\n                <h3>{{ userForm.realName || userForm.username }}</h3>\r\n                <p>{{ getRoleName(userRole) }}</p>\r\n              </div>\r\n            </div>\r\n            \r\n            <div class=\"stats-section\">\r\n              <h4>我的统计</h4>\r\n              <div class=\"stat-item\">\r\n                <span class=\"stat-label\">参与活动</span>\r\n                <span class=\"stat-value\">{{ userStats.activities }}</span>\r\n              </div>\r\n              <div class=\"stat-item\">\r\n                <span class=\"stat-label\">申报成果</span>\r\n                <span class=\"stat-value\">{{ userStats.achievements }}</span>\r\n              </div>\r\n              <div class=\"stat-item\">\r\n                <span class=\"stat-label\">参与项目</span>\r\n                <span class=\"stat-value\">{{ userStats.projects }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      \r\n      <!-- 密码修改 -->\r\n      <div class=\"password-card\">\r\n        <h3>修改密码</h3>\r\n        <el-form\r\n          ref=\"passwordFormRef\"\r\n          :model=\"passwordForm\"\r\n          :rules=\"passwordRules\"\r\n          label-width=\"120px\"\r\n          @submit.prevent=\"handleChangePassword\"\r\n        >\r\n          <el-form-item label=\"原密码\" prop=\"oldPassword\">\r\n            <el-input\r\n              v-model=\"passwordForm.oldPassword\"\r\n              type=\"password\"\r\n              show-password\r\n            />\r\n          </el-form-item>\r\n          \r\n          <el-form-item label=\"新密码\" prop=\"newPassword\">\r\n            <el-input\r\n              v-model=\"passwordForm.newPassword\"\r\n              type=\"password\"\r\n              show-password\r\n            />\r\n          </el-form-item>\r\n          \r\n          <el-form-item label=\"确认密码\" prop=\"confirmPassword\">\r\n            <el-input\r\n              v-model=\"passwordForm.confirmPassword\"\r\n              type=\"password\"\r\n              show-password\r\n            />\r\n          </el-form-item>\r\n          \r\n          <el-form-item>\r\n            <el-button type=\"primary\" :loading=\"passwordLoading\" @click=\"handleChangePassword\">\r\n              修改密码\r\n            </el-button>\r\n            <el-button @click=\"handleResetPassword\">重置</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, computed, onMounted } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { ElMessage } from 'element-plus'\r\nimport { updateProfile, changePassword } from '@/api/auth'\r\nimport router from '@/router'\r\n\r\nexport default {\r\n  name: 'Profile',\r\n  setup() {\r\n    const store = useStore()\r\n    \r\n    const formRef = ref()\r\n    const passwordFormRef = ref()\r\n    const loading = ref(false)\r\n    const passwordLoading = ref(false)\r\n    \r\n    const user = computed(() => store.getters.user)\r\n    const userRole = computed(() => store.getters.userRole)\r\n    \r\n    const userForm = reactive({\r\n      username: '',\r\n      realName: '',\r\n      email: '',\r\n      phone: '',\r\n      studentId: '',\r\n      department: '',\r\n      major: '',\r\n      grade: '',\r\n      gender: 1,\r\n      avatar: ''\r\n    })\r\n    \r\n    const passwordForm = reactive({\r\n      oldPassword: '',\r\n      newPassword: '',\r\n      confirmPassword: ''\r\n    })\r\n    \r\n    const userStats = reactive({\r\n      activities: 5,\r\n      achievements: 3,\r\n      projects: 2\r\n    })\r\n    \r\n    const rules = {\r\n      realName: [\r\n        { required: true, message: '请输入真实姓名', trigger: 'blur' }\r\n      ],\r\n      email: [\r\n        { required: true, message: '请输入邮箱', trigger: 'blur' },\r\n        { type: 'email', message: '请输入正确的邮箱格式', trigger: 'blur' }\r\n      ],\r\n      phone: [\r\n        { required: true, message: '请输入手机号', trigger: 'blur' },\r\n        { pattern: /^1[3-9]\\d{9}$/, message: '请输入正确的手机号', trigger: 'blur' }\r\n      ]\r\n    }\r\n    \r\n    const validateConfirmPassword = (rule, value, callback) => {\r\n      if (value !== passwordForm.newPassword) {\r\n        callback(new Error('两次输入的密码不一致'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    \r\n    const passwordRules = {\r\n      oldPassword: [\r\n        { required: true, message: '请输入原密码', trigger: 'blur' }\r\n      ],\r\n      newPassword: [\r\n        { required: true, message: '请输入新密码', trigger: 'blur' },\r\n        { min: 6, message: '密码长度不能少于6位', trigger: 'blur' }\r\n      ],\r\n      confirmPassword: [\r\n        { required: true, message: '请确认新密码', trigger: 'blur' },\r\n        { validator: validateConfirmPassword, trigger: 'blur' }\r\n      ]\r\n    }\r\n    \r\n    const getRoleName = (role) => {\r\n      const roleMap = {\r\n        'STUDENT': '学生',\r\n        'TEACHER': '教师',\r\n        'ADMIN': '管理员'\r\n      }\r\n      return roleMap[role] || role\r\n    }\r\n    \r\n    const loadUserData = () => {\r\n      if (user.value) {\r\n        Object.assign(userForm, {\r\n          username: user.value.username || '',\r\n          realName: user.value.realName || '',\r\n          email: user.value.email || '',\r\n          phone: user.value.phone || '',\r\n          studentId: user.value.studentId || '',\r\n          department: user.value.department || '',\r\n          major: user.value.major || '',\r\n          grade: user.value.grade || '',\r\n          gender: user.value.gender || 1,\r\n          avatar: user.value.avatar || ''\r\n        })\r\n      }\r\n    }\r\n    \r\n    const handleUpdate = async () => {\r\n      if (!formRef.value) return\r\n      \r\n      await formRef.value.validate(async (valid) => {\r\n        if (valid) {\r\n          loading.value = true\r\n          try {\r\n            // 调用真实API更新用户信息（使用auth模块的updateProfile，不需要用户ID）\r\n            await updateProfile(userForm)\r\n            \r\n            // 更新store中的用户信息\r\n            store.dispatch('updateUser', userForm)\r\n            ElMessage.success('信息更新成功')\r\n          } catch (error) {\r\n            ElMessage.error('更新失败: ' + (error.response?.data?.message || error.message))\r\n          } finally {\r\n            loading.value = false\r\n          }\r\n        }\r\n      })\r\n    }\r\n    \r\n    const handleReset = () => {\r\n      loadUserData()\r\n    }\r\n    \r\n    const handleChangePassword = async () => {\r\n      if (!passwordFormRef.value) return\r\n      \r\n      await passwordFormRef.value.validate(async (valid) => {\r\n        if (valid) {\r\n          passwordLoading.value = true\r\n          try {\r\n            // 调用真实API修改密码\r\n            await changePassword({\r\n              oldPassword: passwordForm.oldPassword,\r\n              newPassword: passwordForm.newPassword\r\n            })\r\n            \r\n            ElMessage.success('密码修改成功')\r\n            // 先重置表单，再进行路由跳转\r\n            handleResetPassword()\r\n            // 短暂延迟，确保用户看到成功提示\r\n            setTimeout(() => {\r\n              router.push('/login')\r\n            }, 1000)\r\n          } catch (error) {\r\n            ElMessage.error('密码修改失败: ' + (error.response?.data?.message || error.message))\r\n          } finally {\r\n            passwordLoading.value = false\r\n          }\r\n        }\r\n      })\r\n    }\r\n    \r\n    const handleResetPassword = () => {\r\n      if (passwordFormRef.value) {\r\n        passwordFormRef.value.resetFields()\r\n      }\r\n    }\r\n    \r\n    onMounted(() => {\r\n      loadUserData()\r\n    })\r\n    \r\n    return {\r\n      formRef,\r\n      passwordFormRef,\r\n      loading,\r\n      passwordLoading,\r\n      user,\r\n      userRole,\r\n      userForm,\r\n      passwordForm,\r\n      userStats,\r\n      rules,\r\n      passwordRules,\r\n      getRoleName,\r\n      handleUpdate,\r\n      handleReset,\r\n      handleChangePassword,\r\n      handleResetPassword\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.profile {\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.page-header {\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.page-header h1 {\r\n  margin: 0;\r\n  color: #2c3e50;\r\n  font-size: 24px;\r\n}\r\n\r\n.profile-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20px;\r\n}\r\n\r\n.profile-card,\r\n.avatar-card,\r\n.password-card {\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n  padding: 30px;\r\n}\r\n\r\n.profile-card h3,\r\n.password-card h3 {\r\n  margin: 0 0 20px 0;\r\n  color: #2c3e50;\r\n  font-size: 18px;\r\n}\r\n\r\n.avatar-section {\r\n  text-align: center;\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.user-info h3 {\r\n  margin: 15px 0 5px 0;\r\n  color: #2c3e50;\r\n  font-size: 20px;\r\n}\r\n\r\n.user-info p {\r\n  margin: 0;\r\n  color: #7f8c8d;\r\n  font-size: 14px;\r\n}\r\n\r\n.stats-section h4 {\r\n  margin: 0 0 15px 0;\r\n  color: #2c3e50;\r\n  font-size: 16px;\r\n}\r\n\r\n.stat-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 10px 0;\r\n  border-bottom: 1px solid #f0f0f0;\r\n}\r\n\r\n.stat-item:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.stat-label {\r\n  color: #7f8c8d;\r\n  font-size: 14px;\r\n}\r\n\r\n.stat-value {\r\n  color: #409eff;\r\n  font-size: 18px;\r\n  font-weight: bold;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .profile-card,\r\n  .avatar-card,\r\n  .password-card {\r\n    padding: 20px;\r\n  }\r\n  \r\n  .avatar-section {\r\n    margin-bottom: 20px;\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./Profile.vue?vue&type=template&id=bd960cec&scoped=true\"\nimport script from \"./Profile.vue?vue&type=script&lang=js\"\nexport * from \"./Profile.vue?vue&type=script&lang=js\"\n\nimport \"./Profile.vue?vue&type=style&index=0&id=bd960cec&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-bd960cec\"]])\n\nexport default __exports__"],"names":["login","data","url","method","register","changePassword","updateProfile","class","gutter","span","ref","model","userForm","rules","handleUpdate","label","prop","username","disabled","realName","email","phone","studentId","department","major","grade","gender","type","loading","handleReset","size","src","avatar","charAt","getRoleName","userRole","userStats","activities","achievements","projects","passwordForm","passwordRules","handleChangePassword","oldPassword","newPassword","confirmPassword","passwordLoading","handleResetPassword","name","setup","store","formRef","passwordFormRef","user","getters","required","message","trigger","pattern","validateConfirmPassword","rule","value","callback","Error","min","validator","role","roleMap","loadUserData","Object","assign","async","validate","valid","dispatch","success","error","response","setTimeout","router","push","resetFields","__exports__","render"],"sourceRoot":""}